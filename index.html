<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AI Course Assistant (Pilot)</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#f7f7fb;color:#222;}
  .wrap{max-width:900px;margin:40px auto;padding:24px;background:#fff;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,.06)}
  h1{font-size:18px;margin:0 0 8px}
  p.lead{margin:0 0 16px;color:#555}
  .log{background:#fafafa;border:1px solid #eee;border-radius:10px;padding:16px;height:420px;overflow:auto}
  .msg{padding:10px 12px;border-radius:10px;margin:8px 0;max-width:720px;line-height:1.4}
  .msg.bot{background:#f2f4f7}
  .msg.user{background:#e6f2ff}
  .menu{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
  .q{background:#ff6a00;border:none;color:#fff;padding:10px 12px;border-radius:8px;cursor:pointer}
  .q:hover{opacity:.9}
  .bar{display:flex;gap:8px;margin-top:12px}
  .btn{background:#eee;border:1px solid #ddd;border-radius:8px;padding:6px 10px;cursor:pointer}
  .btn:hover{background:#f5f5f5}
  small.tip{display:block;margin-top:8px;color:#777}
</style>
</head>
<body>
  <div class="wrap">
    <h1>AI Course Assistant (Pilot)</h1>
    <p class="lead">Answers common course admin questions (modules, deadlines, support). For academic/grading queries, please contact your tutor.</p>

    <div id="log" class="log" aria-live="polite"></div>
    <div id="menu" class="menu"></div>

    <div class="bar">
      <button id="restart" class="btn">Restart</button>
      <button id="clear" class="btn">Clear (forget previous in this tab)</button>
    </div>
    <small class="tip">Tip: embed this page in Moodle/Canvas using an iframe.</small>
  </div>

<script>
const courseName = "Sustainable Cooling: Building Resilience to Extreme Heat (May 25)";

const QUESTIONS = [
  { id:"modules", text:"How many modules do we have?",
    answer:"We have <strong>8 modules</strong> in total." },
  { id:"support", text:"Who can I contact for technical support?",
    answer:"Please email <strong>support@…</strong> and include your <em>full name</em> and <em>course title</em>." },
  { id:"pass", text:"What is the minimum score to pass the course?",
    answer:"You’ll need to achieve at least <strong>75% overall</strong> to complete the course successfully and qualify for your certificate." }
];

const askedKey = "ai_course_assistant_asked";
const asked = new Set(JSON.parse(sessionStorage.getItem(askedKey) || "[]"));

const log = document.getElementById("log");
const menu = document.getElementById("menu");

function addMsg(text, who="bot"){
  const div = document.createElement("div");
  div.className = `msg ${who}`;
  div.innerHTML = text;
  log.appendChild(div);
  log.scrollTop = log.scrollHeight;
}

function saveAsked(){
  sessionStorage.setItem(askedKey, JSON.stringify(Array.from(asked)));
}

function renderMenu(){
  menu.innerHTML = "";
  const remaining = QUESTIONS.filter(q => !asked.has(q.id));

  if(remaining.length === 0){
    addMsg("That’s all I can help with in this pilot. For anything else, please contact your tutor.");
    return;
  }
  remaining.forEach(q=>{
    const b = document.createElement("button");
    b.className = "q";
    b.type = "button";
    b.textContent = q.text;
    b.onclick = () => ask(q.id);
    menu.appendChild(b);
  });
}

function ask(id){
  const q = QUESTIONS.find(x => x.id === id);
  if(!q) return;
  addMsg(q.text, "user");
  asked.add(id);
  saveAsked();
  addMsg(q.answer);
  renderMenu();
}

function start(){
  log.innerHTML = "";
  addMsg(`Hi! I’m your Course Assistant for <em>${courseName}</em>. I can answer a few common course questions about deadlines, extensions, and certificates. What would you like to know?`);
  renderMenu();
}

document.getElementById("restart").onclick = () => { asked.clear(); saveAsked(); start(); };
document.getElementById("clear").onclick = () => { sessionStorage.removeItem(askedKey); asked.clear(); start(); };

start();
</script>
</body>
</html>
